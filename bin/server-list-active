#!/usr/bin/env ruby
$:.unshift(File.join(File.dirname(__FILE__), "..", "lib"))
require "poolparty/lite"

list_type = ARGV.pop || "ip"

json_file = ARGV[0] || PoolParty::Default.properties_hash_file
raise "ERROR: no json_file given" if !json_file
schema = PoolParty::Schema.new( ::File.read(json_file) )

remoter_base = schema.options.remote_base

instances = PoolParty::Remote::Ec2.describe_instances(schema.options)
print instances.map {|inst| inst.send list_type.to_sym }.join("\t")